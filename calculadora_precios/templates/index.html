<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Precios</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f7f7f7; }
    input[type="text"], input[type="number"] {
      padding: 5px; margin: 5px; width: 150px;
    }
    .producto { margin-bottom: 10px; }
    .resultado { margin-top: 2rem; background: #fff; padding: 1rem; border-radius: 10px; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #333; color: white; }
  </style>
  <script>
    function agregarProducto() {
      const contenedor = document.getElementById("productos");
      const div = document.createElement("div");
      div.classList.add("producto");
      div.innerHTML = `
        <input type="text" name="nombre" placeholder="Nombre del producto" required>
        <input type="number" step="0.01" name="precio_usd" placeholder="Precio USD" required>
      `;
      contenedor.appendChild(div);
    }
  </script>
</head>
<body>

  <h1>ðŸ’° Calculadora de Precios con Ganancia</h1>

  <form method="POST">
    <label>Envio total (USD):</label><br>
    <input type="number" step="0.01" name="envio_usd" required><br>

    <label>Impuestos totales (ARS):</label><br>
    <input type="number" step="0.01" name="impuesto_ars" required><br>

    <label>CotizaciÃ³n del dÃ³lar (USD a ARS):</label><br>
    <input type="number" step="0.01" name="dolar_ars" required><br><br>

    <h3>Productos:</h3>
    <div id="productos">
      <div class="producto">
        <input type="text" name="nombre" placeholder="Nombre del producto" required>
        <input type="number" step="0.01" name="precio_usd" placeholder="Precio USD" required>
      </div>
    </div>
    <button type="button" onclick="agregarProducto()">+ Agregar producto</button><br><br>

    <button type="submit">Calcular</button>
  </form>

  {% if resultados %}
  <div class="resultado">
    <h2>Resultados:</h2>
    <table>
      <tr>
        <th>Producto</th>
        <th>Precio USD</th>
        <th>Costo sin ganancia (ARS)</th>
        <th>Ganancia (%)</th>
        <th>Ganancia (ARS)</th>
        <th>Precio final (ARS)</th>
      </tr>
      {% for p in resultados %}
      <tr>
        <td>{{ p.nombre }}</td>
        <td>{{ p.precio_usd }}</td>
        <td>{{ p.costo_sin_ganancia }}</td>
        <td>{{ p.ganancia_pct }}%</td>
        <td>{{ p.ganancia_ars }}</td>
        <td><strong>{{ p.precio_final }}</strong></td>
      </tr>
      {% endfor %}
    </table>
    <p><strong>ðŸ’µ Ganancia total estimada:</strong> ${{ total_ganancia }} ARS</p>
  </div>
  {% endif %}

</body>
</html>
